                             Tmispell, versio 0.2.3

  Pauli Virtanen <pauli.virtanen@hut.fi>

   --------------------------------------------------------------------------

Mikä Tmispell on?

   Tmispell on Ispell-yhteensopiva käyttöliittymä oikolukumoduuleille.
   Varsinaisen oikoluvun suomea varten hoitaa korkealaatuinen oikolukumoduuli
   [1]Soikko, jonka on tehnyt Pasi Ryhänen.

   Tmispell on hyödyllinen, koska monet ohjelmat (esim. postiohjelmat sekä
   tekstinkäsittelyohjelmat) käyttävät Ispelliä oikolukemiseen. Koska
   Tmispell on myös Ispell-yhteensopiva, nämä ohjelmat voivat käyttää sitä
   ilman että mitään tarvitsee muuttaa.

   Lisäksi Tmispell osaa käynnistää alkuperäisen Ispellin, kun jollekin
   kielelle ei ole moduulia. Tämän vuoksi Tmispell sopii sellaisenaan
   Ispellin korvikkeeksi.

Käyttö

   Tällä hetkellä Tmispellissä on tekstikäyttöliittymä, jota voi käyttää
   tekstien oikolukemiseen. Sen voi käynnistää kirjoittamalla

 tmispell -dsuomi tiedosto.txt

   Kun väärin kirjoitettu sana löytyy, kysyy ohjelma mitä tehdä.
   Käyttöliittymän toiminnan pitäisi olla melko itsestäänselvää, mutta
   luettelon käytettävistä näppäimistä saa kirjoittamalla "?".

   Jos haluat käyttää suodattimia, kirjoita yksi valitsimista '-t', '-n' tai
   '-h' (vastaavat muotoja TeX, nroff ja sgml) oikoluettavan tiedoston nimen
   eteen. Lisätietoja valitsimista on Ispellin manuaalisivulla ispell(1).

Asennus

   Nämä ohjeet kertovat, miten Tmispell käännetään ja asennetaan
   lähdekoodipaketista. Olemassa on myös valmiita paketteja, joita kannattaa
   käyttää, jos ei halua tehdä asioita vaikeasti.

    1. Tmispellin kääntäminen ja asennus:

           ./configure
           make
           make install


       make install vain kopioi Tmispell-ohjelman ja manuaalisivun sopiviin
       paikkoihin.

    2. Hae ja asenna Soikko (ks. http://www.iki.fi/~pry/soikko/).

    3. Luo asetustiedosto, ja sijoita se sinne, mistä Tmispell sen löytää.
       Mallina on esimerkkitiedosto tmispell.conf.example. (Katso
       "Asetustiedoston muoto" alempana.) Tarkista, että tiedostojen polut
       oikolukumoduuliriveillä ovat oikein.

    4. Saadaksesi muut ohjelmat käyttämään Tmispelliä Ispellin sijaan, siirrä
       ensin alkuperäinen Ispell-ohjelmatiedosto syrjään, ja luo linkki
       "ispell", joka osoittaa tmispelliin. Esimerkiksi siis:

             mv /usr/bin/ispell /usr/bin/ispell.real
             ln -s /usr/local/bin/tmispell /usr/bin/ispell


       Muista muuttaa "ispell=..."-rivi asetustiedostossa osoittamaan
       alkuperäiseen Ispell-ohjelmaan.

       Muiden ohjelmien täytyy tietää, että suomen oikoluku on mahdollista,
       joten aja seuraava komento luodaksesi tarvittavat "sanastotiedostot":

             touch /usr/lib/ispell/suomi.{hash,aff}


       Huomaa, että tiedostojen polku voisi olla myös "/usr/share/ispell" tai
       jotakin vastaavaa järjestelmästäsi riippuen.

    5. Tarkistaaksesi, että Tmispell toimii kunnolla, kirjoita seuraava
       komento:

             ispell -dsuomi -a


       Jos määrittelit sanaston nimeltä "suomi" asetustiedostossa, niin
       seuraavanlaisen rivin pitäisi näkyä:

 @(#) International Ispell Version 3.1.20 compatible tmispell 0.1.1

       Nyt voit kirjoittaa sanoja oikoluettavaksi. Lisätietoja tästä
       komentotilasta saa manuaalisivulta ispell(1).

Ohjelmakohtaisia ohjeita

     o Emacs (sekä Ispell- että Flyspell-tilat)

       Note that you might have to add something like the following to your
       ~/.emacs configuration file, since Ispell support in Emacs does not
       know about Finnish dictionary by default:

 (setq ispell-local-dictionary-alist
       (append ispell-local-dictionary-alist
        '(("suomi"
           "[%.0-9A-Za-z\247\300-\326\330-\366\370-\377-]"
           "[^.%0-9A-Za-z\247\300-\326\330-\366\370-\377-]"
           "[':]" nil nil nil iso-8859-1))))

       Depending on your configuration, the ispell-local-dictionary-alist
       could also be ispell-dictionary-alist. You can change the active
       dictionary with the command "M-x ispell-change-dictionary". If you
       like to have Finnish as the default dictionary, add also:

 (setq ispell-dictionary "suomi")

       If you still encounter problems (e.g. with TeX files), try turning the
       multi byte character support of Emacs off.

     o Pspell (Sylpheed, Balsa ja monet muut)

       Vaikka Pspelliä ollaankin korvaamassa Aspellillä, jotkin ohjelmat
       käyttävät sitä vielä. Tmispelliä voi käyttää Pspellin kanssa, jos
       Pspellin pspell-ispell-moduuli on asennettu, ja on olemassa tiedosto
       /usr/share/pspell/fi-ispell.pwli, jossa on seuraava rivi:

 /usr/lib/ispell/suomi.hash iso8859-15

     o Muut ohjelmat (useimmat KDE-ohjelmat, LyX, ...)

       Kun "sanastotiedostot" ovat olemassa (katso asennus), suomen pitäisi
       näkyä yhtenä kielivaihtoehtona näissä ohjelmissa.

Asetustiedoston muoto

   Asetustiedosto sisältää oikolukumoduulimerkintöjä sekä asetuksia. "#" on
   kommenttimerkki: kaikki teksti rivillä sen jälkeen jää huomiotta.

   Asetusten muoto on yksinkertainen:

 avain=arvo

   Huomaa, että arvomerkkijono voi olla usean rivin mittainen, jos se on
   lainausmerkkien välissä.

   Mahdolliset asetukset ovat:

   ispell

           Varalla käytettävän oikean Ispell-ohjelmatiedoston sijainti.
           Huomaa, että koko polku tiedostoon täytyy antaa. Tämä asetus
           täytyy aina määritellä.

   tex-command-filter

           Luettelo TeX-komennoista ja parametreista, joita TeX-suodatin
           käsittelee erityisesti. Syntaksi on "komento oOpP, ...", jossa
           "oOpP" on merkkijono, jonka merkit tarkoittavat komennon
           erityyppisiä parametreja. Iso kirjain tarkoittaa, että parametri
           tulisi oikolukea, ja pieni, että sitä ei tulisi oikolukea. "O" ja
           "o" merkitsevät valinnaista ja "P" ja "p" tavallista (pakollista)
           parametria.

   tex-environment-filter

           Luettelo ympäristöistä, joiden oikoluvun TeX-suodatin estää.

   sgml-attributes-to-check

           Luettelo SGML- tai HTML-määreistä, jotka tulisi oikolukea.

   Sanastomääritelmässä on 7 merkkijonoa samalla rivillä välein eroteltuina,
   ja tarvittaessa lainausmerkeissä. Kenoviivaa voi käyttää merkkien
   suojaamiseen lainausmerkkien sisällä. Merkkijonojen merkitykset ovat:

    1. Nimi, jolla sanasto tunnetaan; vastaa Ispellin hash-tiedoston nimeä
       ilman ".hash"-päätettä. Pakollinen.

    2. Ladattavan kirjastotiedoston nimi. Pakollinen.

    3. Kirjastotiedoston käyttämä sanasto. Pakollinen.

    4. Moduulin syötteen merkistö, esimerkiksi latin9. Pakollinen.

    5. Maa-asetustomuuttujan LC_CTYPE arvo, jota käytetään tämän moduulin
       kanssa. Se määrittelee oletusarvoisesti merkit, jotka kuuluvat
       sanoihin. Jos tyhjä tai puuttuu, niin sopivan ympäristömuuttujan arvo
       on käytössä.

    6. Joukko lisämerkkejä, jotka voivat kuulua sanoihin. Jos tyhjä tai
       puuttuu, niin vain maa-asetuston määrittelemät merkit kuuluvat
       sanoihin.

    7. Välimerkit. Nämä merkit kuuluvat sanaan, vain jos ovat sen sisällä.
       Jos tyhjä tai puuttuu, välimerkkejä ei oleteta.

   Esimerkki 1. Asetustiedostoesimerkki

 ispell=/usr/bin/ispell.real

 suomi "/usr/local/OpenOffice.org1.0/program/libsoikko.so" "/usr/local/OpenOffice.org1.0/share/dict/soikko-sp.fi_FI.dic" "latin9" "fi_FI@euro" "." "-':"

 tex-command-filter="begin po, end p, usepackage op, newcommand poOP"
 tex-environment-filter="equation $ eqnarray displaymath math"

   Asetustiedoston ensimmäinen rivi määrittelee tässä varalla olevan
   ispell-ohjelman.

   Toinen rivi lisää suomea varten moduulin, jonka tunnisteeksi tulee "suomi"
   ja joka käyttää annettua kirjastotiedostoa annetun sanastotiedoston
   kanssa. Syötteen merkistö on iso-8859-15 eli "latin9". Vain maa-asetuston
   "fi_FI@euro" määrittelemät merkit ja piste lasketaan sanoihin kuuluviksi,
   ja välimerkeiksi käyvät "-", ", "'" ja ":".

   Joka kerta siis kun Tmispell käynnistetään valitsimin "-d suomi" tai "-d
   /usr/lib/ispell/suomi.hash", niin Soikko-moduuli hoitaa oikoluvun. Muissa
   tapauksissa tavallinen Ispell käynnistyy.

   Viides rivi määrittelee, että TeX-suodatin estää komentojen begin{}, end{}
   ja usepackage{} parametrien oikoluvun, muttei komennon newcommand toisen
   valinnaisen ja pakollisen parametrin oikolukua.

   Kuudes rivi määrittelee, että TeX-tilassa matematiikkaympäristöjä ei
   oikolueta.

Tunnetut ongelmat

  Puuttuvat ominaisuudet

     o SGML-suodattimen tulisi osata purkaa ja koodata entiteettejä. Jotta
       tämän voisi tehdä järkevästi, tarvittaneen muutoksia
       suodatinarkkitehtuuriin.

     o Monitavumerkistöjen (UTF-8, UTF-16, ...) tuki puuttuu. Voisi liittyä
       entiteettien koodaamiseen ja purkamiseen jne.

  Muuta tehtävää

     o Mieti, miten Aspell-tuki pitäisi toteuttaa. Onko Soikko-pätsätylle
       Aspellille tarvetta?

     o Mieti Ispellin "extended charactereja" (mitä lienevätkään).

References

   Visible links
   1. http://www.iki.fi/~pry/soikko/
