<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE article PUBLIC "-//OASIS//DTD DocBook XML V4.2//EN" "/usr/share/sgml/docbook/dtd/xml/4.2/docbookx.dtd" [
<!ENTITY tmispell-description SYSTEM "tmispell.description.ent">
<!ENTITY tmispell-configfile SYSTEM "tmispell.configfile.ent">
<!ENTITY tmispell-configfile-example SYSTEM "tmispell.configfile-example.ent">
<!ENTITY tmispell-todo SYSTEM "tmispell.todo.ent">
]>
<article>
  <articleinfo>
    <author>
      <firstname>Pauli</firstname>
      <surname>Virtanen</surname>
      <email>pauli.virtanen@hut.fi</email>
    </author>
    
    <title>Tmispell, versio 0.2.3</title>
  </articleinfo>
  
  
  <sect1>
    <title>Mikä Tmispell on?</title>
    

  <para>Tmispell on Ispell-yhteensopiva käyttöliittymä oikolukumoduuleille. Varsinaisen oikoluvun suomea varten hoitaa korkealaatuinen oikolukumoduuli <ulink url="http://www.iki.fi/~pry/soikko/">Soikko</ulink>, jonka on tehnyt Pasi Ryhänen.</para>
  <para>Tmispell on hyödyllinen, koska monet ohjelmat (esim. postiohjelmat sekä tekstinkäsittelyohjelmat) käyttävät Ispelliä oikolukemiseen. Koska Tmispell on myös Ispell-yhteensopiva, nämä ohjelmat voivat käyttää sitä ilman että mitään tarvitsee muuttaa.</para>
  <para>Lisäksi Tmispell osaa käynnistää alkuperäisen Ispellin, kun jollekin kielelle ei ole moduulia. Tämän vuoksi Tmispell sopii sellaisenaan Ispellin korvikkeeksi.</para>

  </sect1>
  
  <sect1>
    <title>Käyttö</title>
    <para>Tällä hetkellä Tmispellissä on tekstikäyttöliittymä, jota voi käyttää tekstien oikolukemiseen. Sen voi käynnistää kirjoittamalla <screen><userinput>tmispell -dsuomi <replaceable>tiedosto.txt</replaceable></userinput></screen> Kun väärin kirjoitettu sana löytyy, kysyy ohjelma mitä tehdä. Käyttöliittymän toiminnan pitäisi olla melko itsestäänselvää, mutta luettelon käytettävistä näppäimistä saa kirjoittamalla "?".</para>
    <para>Jos haluat käyttää suodattimia, kirjoita yksi valitsimista '<option>-t</option>', '<option>-n</option>' tai '<option>-h</option>' (vastaavat muotoja TeX, nroff ja sgml) oikoluettavan tiedoston nimen eteen. Lisätietoja valitsimista on Ispellin manuaalisivulla ispell(1).</para>
  </sect1>

  <sect1>
    <title>Asennus</title>
    <para>Nämä ohjeet kertovat, miten Tmispell käännetään ja asennetaan lähdekoodipaketista. Olemassa on myös valmiita paketteja, joita kannattaa käyttää, jos ei halua tehdä asioita vaikeasti.</para>
    <procedure>
      <step>
	<para>Tmispellin kääntäminen ja asennus:</para>
	<screen>
	  <userinput>./configure</userinput>
	  <userinput>make</userinput>
	  <userinput>make install</userinput>
	</screen>

	<para><command>make install</command> vain kopioi Tmispell-ohjelman ja manuaalisivun sopiviin paikkoihin.</para>
      </step>
      <step>
        <para>Hae ja asenna Soikko (ks. http://www.iki.fi/~pry/soikko/).</para>
      </step>
      <step>
	<para>Luo asetustiedosto, ja sijoita se sinne, mistä Tmispell sen löytää. Mallina on esimerkkitiedosto <filename>tmispell.conf.example</filename>. (Katso "Asetustiedoston muoto" alempana.) Tarkista, että tiedostojen polut oikolukumoduuliriveillä ovat oikein.</para>
      </step>
      <step>
	<para>Saadaksesi muut ohjelmat käyttämään Tmispelliä Ispellin sijaan, siirrä ensin alkuperäinen Ispell-ohjelmatiedosto syrjään, ja luo linkki "ispell", joka osoittaa tmispelliin. Esimerkiksi siis: <screen>
	    <userinput>mv /usr/bin/ispell /usr/bin/ispell.real</userinput>
	    <userinput>ln -s /usr/local/bin/tmispell /usr/bin/ispell</userinput>
	  </screen> Muista muuttaa "ispell=..."-rivi asetustiedostossa osoittamaan alkuperäiseen Ispell-ohjelmaan.</para>
	<para>Muiden ohjelmien täytyy tietää, että suomen oikoluku on mahdollista, joten aja seuraava komento luodaksesi tarvittavat "sanastotiedostot": <screen>
	    <userinput>touch /usr/lib/ispell/suomi.{hash,aff}</userinput>
	  </screen> Huomaa, että tiedostojen polku voisi olla myös "/usr/share/ispell" tai jotakin vastaavaa järjestelmästäsi riippuen.</para>
      </step>
      <step>
	<para>Tarkistaaksesi, että Tmispell toimii kunnolla, kirjoita seuraava komento: <screen>
	    <userinput>ispell -dsuomi -a</userinput>
	  </screen> Jos määrittelit sanaston nimeltä "suomi" asetustiedostossa, niin seuraavanlaisen rivin pitäisi näkyä: <screen>@(#) International Ispell Version 3.1.20 compatible tmispell 0.1.1</screen> Nyt voit kirjoittaa sanoja oikoluettavaksi. Lisätietoja tästä komentotilasta saa manuaalisivulta ispell(1).</para>
      </step>
    </procedure>
  </sect1>

  <sect1>
    <title>Ohjelmakohtaisia ohjeita</title>

    <itemizedlist>
      <listitem>
	<simpara>Emacs (sekä Ispell- että Flyspell-tilat)</simpara>
	<para>
	  Note that you might have to add something like the
	  following to your <filename>~/.emacs</filename>
	  configuration file, since Ispell support in Emacs does not
	  know about Finnish dictionary by default:

<screen><![CDATA[(setq ispell-local-dictionary-alist
      (append ispell-local-dictionary-alist
       '(("suomi"
          "[%.0-9A-Za-z\247\300-\326\330-\366\370-\377-]"
          "[^.%0-9A-Za-z\247\300-\326\330-\366\370-\377-]"
          "[':]" nil nil nil iso-8859-1))))]]></screen>

	  Depending on your configuration, the ispell-local-dictionary-alist
	  could also be ispell-dictionary-alist.

	  You can change the active dictionary with the command
	  "M-x ispell-change-dictionary".

	  If you like to have Finnish as the default dictionary, add
	  also: 
	  <screen>(setq ispell-dictionary "suomi")</screen>
	  If you still encounter problems (e.g. with TeX files),
	  try turning the multi byte character support of Emacs off.
	</para>
      </listitem>
      
      <listitem>
	<simpara>Pspell (Sylpheed, Balsa ja monet muut)</simpara>
	<para>Vaikka Pspelliä ollaankin korvaamassa Aspellillä, jotkin ohjelmat käyttävät sitä vielä. Tmispelliä voi käyttää Pspellin kanssa, jos Pspellin pspell-ispell-moduuli on asennettu, ja on olemassa tiedosto <filename>/usr/share/pspell/fi-ispell.pwli</filename>, jossa on seuraava rivi: <screen>/usr/lib/ispell/suomi.hash iso8859-15</screen></para>
      </listitem>
      
      <listitem>
	<simpara>Muut ohjelmat (useimmat KDE-ohjelmat, LyX, ...)</simpara>
	<para>Kun "sanastotiedostot" ovat olemassa (katso asennus), suomen pitäisi näkyä yhtenä kielivaihtoehtona näissä ohjelmissa.</para>
      </listitem>
    </itemizedlist>
  </sect1>
    
  <sect1 id="config-file-format">
    <title>Asetustiedoston muoto</title>
    

  <para>Asetustiedosto sisältää oikolukumoduulimerkintöjä sekä asetuksia. "#" on kommenttimerkki: kaikki teksti rivillä sen jälkeen jää huomiotta.</para>

  <para>Asetusten muoto on yksinkertainen: <screen><replaceable>avain</replaceable>=<replaceable>arvo</replaceable></screen> Huomaa, että arvomerkkijono voi olla usean rivin mittainen, jos se on lainausmerkkien välissä.</para>
  <para>Mahdolliset asetukset ovat: <variablelist>
      <varlistentry>
	<term>ispell</term> 
	<listitem><para>Varalla käytettävän oikean Ispell-ohjelmatiedoston sijainti. Huomaa, että koko polku tiedostoon täytyy antaa. Tämä asetus täytyy aina määritellä.</para></listitem>
      </varlistentry>

      <varlistentry>
	<term>tex-command-filter</term> 
	<listitem>
	  <para>Luettelo TeX-komennoista ja parametreista, joita TeX-suodatin käsittelee erityisesti. Syntaksi on "<replaceable>komento</replaceable> <replaceable>oOpP</replaceable>, ...", jossa "oOpP" on merkkijono, jonka merkit tarkoittavat komennon erityyppisiä parametreja. Iso kirjain tarkoittaa, että parametri tulisi oikolukea, ja pieni, että sitä ei tulisi oikolukea. "O" ja "o" merkitsevät valinnaista ja "P" ja "p" tavallista (pakollista) parametria.</para>
	</listitem>
      </varlistentry>
      
      <varlistentry>
	<term>tex-environment-filter</term> 
	<listitem><para>Luettelo ympäristöistä, joiden oikoluvun TeX-suodatin estää.</para></listitem>
      </varlistentry>

      <varlistentry>
	<term>sgml-attributes-to-check</term>
	<listitem><para>Luettelo SGML- tai HTML-määreistä, jotka tulisi oikolukea.</para></listitem>
      </varlistentry>
    </variablelist></para>

  <para>Sanastomääritelmässä on 7 merkkijonoa samalla rivillä välein eroteltuina, ja tarvittaessa lainausmerkeissä. Kenoviivaa voi käyttää merkkien suojaamiseen lainausmerkkien sisällä. Merkkijonojen merkitykset ovat: <orderedlist continuation="restarts">
      <listitem>
	<para>Nimi, jolla sanasto tunnetaan; vastaa Ispellin hash-tiedoston nimeä ilman ".hash"-päätettä. Pakollinen.</para>
      </listitem>
      <listitem>
	<para>Ladattavan kirjastotiedoston nimi. Pakollinen.</para>
      </listitem>
      <listitem>
	<para>Kirjastotiedoston käyttämä sanasto. Pakollinen.</para>
      </listitem>
      <listitem>
	<para>Moduulin syötteen merkistö, esimerkiksi latin9. Pakollinen.</para>
      </listitem>
      <listitem>
	<para>Maa-asetustomuuttujan <varname>LC_CTYPE</varname> arvo, jota käytetään tämän moduulin kanssa. Se määrittelee oletusarvoisesti merkit, jotka kuuluvat sanoihin. Jos tyhjä tai puuttuu, niin sopivan ympäristömuuttujan arvo on käytössä.</para>
      </listitem>
      <listitem>
	<para>Joukko lisämerkkejä, jotka voivat kuulua sanoihin. Jos tyhjä tai puuttuu, niin vain maa-asetuston määrittelemät merkit kuuluvat sanoihin.</para>
      </listitem>
      <listitem>
	<para>Välimerkit. Nämä merkit kuuluvat sanaan, vain jos ovat sen sisällä. Jos tyhjä tai puuttuu, välimerkkejä ei oleteta.</para>
      </listitem>
    </orderedlist></para>

    

  <example>
    <title>Asetustiedostoesimerkki</title>
    
    <screen><![CDATA[ispell=/usr/bin/ispell.real

suomi "/usr/local/OpenOffice.org1.0/program/libsoikko.so" "/usr/local/OpenOffice.org1.0/share/dict/soikko-sp.fi_FI.dic" "latin9" "fi_FI@euro" "." "-':"

tex-command-filter="begin po, end p, usepackage op, newcommand poOP"
tex-environment-filter="equation $ eqnarray displaymath math"]]></screen>
    
    <para>Asetustiedoston ensimmäinen rivi määrittelee tässä varalla olevan ispell-ohjelman.</para>

    <para>Toinen rivi lisää suomea varten moduulin, jonka tunnisteeksi tulee "suomi" ja joka käyttää annettua kirjastotiedostoa annetun sanastotiedoston kanssa. Syötteen merkistö on iso-8859-15 <acronym>eli</acronym> "latin9". Vain maa-asetuston "fi_FI@euro" määrittelemät merkit ja piste lasketaan sanoihin kuuluviksi, ja välimerkeiksi käyvät "-", ", "'" ja ":".</para>

    <para>Joka kerta siis kun Tmispell käynnistetään valitsimin "-d suomi" tai "-d /usr/lib/ispell/suomi.hash", niin Soikko-moduuli hoitaa oikoluvun. Muissa tapauksissa tavallinen Ispell käynnistyy.</para>

    <para>Viides rivi määrittelee, että TeX-suodatin estää komentojen begin{}, end{} ja usepackage{} parametrien oikoluvun, muttei komennon newcommand toisen valinnaisen ja pakollisen parametrin oikolukua.</para>

    <para>Kuudes rivi määrittelee, että TeX-tilassa matematiikkaympäristöjä ei oikolueta.</para>
  </example>

  </sect1>

  

  <sect1>
    <title>Tunnetut ongelmat</title>
    
    <sect2>
      <title>Puuttuvat ominaisuudet</title>
      <itemizedlist>

	<listitem><para>SGML-suodattimen tulisi osata purkaa ja koodata entiteettejä. Jotta tämän voisi tehdä järkevästi, tarvittaneen muutoksia suodatinarkkitehtuuriin.</para></listitem>
	
	<listitem><para>Monitavumerkistöjen (UTF-8, UTF-16, ...) tuki puuttuu. Voisi liittyä entiteettien koodaamiseen ja purkamiseen jne.</para></listitem>

      </itemizedlist>
    </sect2>

    <sect2>
      <title>Muuta tehtävää</title>

      <itemizedlist>
	<listitem><para>Mieti, miten Aspell-tuki pitäisi toteuttaa. Onko Soikko-pätsätylle Aspellille tarvetta?</para></listitem>

	<listitem><para>Mieti Ispellin "extended charactereja" (mitä lienevätkään).</para></listitem>
	
      </itemizedlist>
    </sect2>
  </sect1>


</article>
